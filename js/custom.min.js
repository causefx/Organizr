var idleTime=0;var hasCookie=false;var loginAttempts=0;$(document).ajaxComplete(function(){pageLoad()});$(document).ready(function(){pageLoad();var d=new Clipboard(".clipboard");var b=new Clipboard("#internal-clipboard");d.on("success",function(f){message("Clipboard",f.text,activeInfo.settings.notifications.position,"#FFF","info","5000");f.clearSelection()});"use strict";var a=$("body");$(window).scroll(function(){if($(this).scrollTop()>100){$("#scroll").fadeIn()}else{$("#scroll").fadeOut()}});$("#scroll").click(function(){$("html, body").animate({scrollTop:0},600);return false});$(function(){var g=function(){var i=40,j=(window.innerWidth>0)?window.innerWidth:this.screen.width,h=((window.innerHeight>0)?window.innerHeight:this.screen.height)-1;if(j<768){$("div.navbar-collapse").addClass("collapse");i=100}else{$("div.navbar-collapse").removeClass("collapse")}if(j<1170){a.addClass("content-wrapper");$(".sidebar-nav, .slimScrollDiv").css("overflow-x","visible").parent().css("overflow","visible")}else{a.removeClass("content-wrapper")}h=h-i;if(h<1){h=1}if(h>i){$("#page-wrapper").css("min-height",(h)+"px")}},e=window.location,f=$("ul.nav a").filter(function(){return this.href===e||e.href.indexOf(this.href)===0}).addClass("activez").parent().parent().addClass("ok").parent();if(f.is("li")){f.addClass("activezo")}$(window).ready(g);$(window).bind("resize",g)});a.trigger("resize");var c=setInterval(timerIncrement,60000);hasCookie=(getCookie("organizrToken"))?true:false;$(this).mousemove(function(f){idleTime=0});$(this).keypress(function(f){idleTime=0});myLazyLoad=new LazyLoad({elements_selector:".lazyload"});(function(g,f,e){var i='[data-perform="panel-collapse"]',h='[data-perform="panel-dismiss"]';g(i).each(function(){var k={toggle:false},j=g(this).closest(".panel"),m=j.find(".panel-wrapper"),l=g(this).children("i");if(!m.length){m=j.children(".panel-heading").nextAll().wrapAll("<div/>").parent().addClass("panel-wrapper");k={}}m.collapse(k).on("hide.bs.collapse",function(){l.removeClass("ti-minus").addClass("ti-plus")}).on("show.bs.collapse",function(){l.removeClass("ti-plus").addClass("ti-minus")})});g(e).on("click",i,function(k){k.preventDefault();var j=g(this).closest(".panel"),l=j.find(".panel-wrapper");g(this).children("i").toggleClass("ti-plus").toggleClass("ti-minus");l.collapse("toggle")});g(e).on("click",h,function(l){l.preventDefault();var k=g(this).closest(".panel");function j(){var m=k.parent();k.remove();m.filter(function(){return(g(this).is('[class*="col-"]')&&g(this).children("*").length===0)}).remove()}j()})}(jQuery,window,document))});function pageLoad(){$(function(){if($("#preloader:visible").length==1){$("#preloader").fadeOut()}myLazyLoad.update()});$(function(){if(bowser.mobile!==true){$('[data-toggle="tooltip"]').tooltip()}});$(function(){$('[data-toggle="popover"]').popover()});$(function(){var a=Array.prototype.slice.call(document.querySelectorAll(".js-switch"));$(".js-switch").each(function(){if($(this).attr("data-switchery")!=="true"){new Switchery($(this)[0],$(this).data())}})});$(".collapseble").on("click",function(){$(".collapseblebox").fadeToggle(350)});$(".popup-with-form").magnificPopup({type:"inline",preloader:true,removalDelay:500,showCloseBtn:false,callbacks:{beforeOpen:function(){if($(window).width()<700){this.st.focus=false}else{this.st.focus="#name"}this.st.mainClass=this.st.el.attr("data-effect")},beforeClose:function(){if($.magnificPopup.instance.currItem.inlineElement.find(".rubberBand").length!==0){if(!$.magnificPopup.instance.currItem.inlineElement.find(".rubberBand").hasClass("hidden")){var a=$.magnificPopup.instance.currItem.index;message("You forgot to save","<a class=\"mouse\" onclick=\"$('.popup-with-form').magnificPopup('open',"+a+')">Would you like to go back?</a>',activeInfo.settings.notifications.position,"#FFF","warning","5000")}}}}});$(".inline-popups").magnificPopup({removalDelay:500,closeOnBgClick:true,showCloseBtn:false,callbacks:{beforeOpen:function(){this.st.mainClass=this.st.el.attr("data-effect");this.st.focus=".inline-focus"},close:function(){if(typeof player!=="undefined"){console.log("STOP STOP STOP");player.destroy()}}},midClick:true})}$(".slimscrollright").slimScroll({height:"100%",position:"right",size:"5px",color:"#dcdcdc"});$(".slimscrollsidebar").slimScroll({height:"100%",position:"left",size:"6px",color:"rgba(0,0,0,0.5)"});if(bowser.mobile!==true){$(".inbox-center").slimScroll({height:"100%",position:"right",size:"5px",color:"#dcdcdc"})}$(".navbar-toggle").on("click",function(){$(".navbar-toggle i").toggleClass("ti-menu").addClass("ti-close")});$(document).on("click","#to-recover",function(a){$("#loginform").slideUp();$("#recoverform").fadeIn()});$(document).on("click",".to-register",function(a){$("#loginform").slideUp();$("#registerForm").removeClass("hidden");$("#registerform").fadeIn()});$(document).on("click","#leave-recover",function(a){$("#loginform").slideDown();$("#recoverform").fadeOut()});$(document).on("click","#leave-registration",function(a){$("#registerform").fadeOut();$("#registerForm").addClass("hidden");$("#loginform").slideDown()});$(document).on("click",".updateNow",function(a){updateNow()});$(document).on("click",".show-login",function(a){buildLogin()});$(document).on("click",".depenency-item",function(a){alert($(this).attr("data-name"))});function doneTypingMediaSearch(){var c=$("#mediaSearchQuery");var b=c.val();var d=c.attr("data-server");if(b==""||b==" "){return false}switch(d){case"plex":var a="getPlexSearch";break;case"emby":var a="getEmbySearch";break;default:}organizrAPI("POST","api/?v1/homepage/connect",{action:a,query:b}).success(function(f){var e=JSON.parse(f);$(".mediaSearch-div").html(buildMediaResults(e.data,d,b));if(bowser.mobile!==true){$(".resultBox-inside").slimScroll({height:"100%",position:"right",size:"5px",color:"#dcdcdc"})}}).fail(function(e){console.error("Organizr Function: API Connection Failed")})}$(document).on("click",".login-button",function(c){c.preventDefault;loginAttempts=loginAttempts+1;$("#login-attempts").val(loginAttempts);var a=(local("g","loggingIn"));if(a==null){local("s","loggingIn",true);$("div.login-box").block({message:'<h5><img width="20" src="plugins/images/busy.gif" /> Just a moment...</h4>',css:{color:"#fff",border:"1px solid #2cabe3",backgroundColor:"#2cabe3"}});var b=$("#loginform").serializeArray();organizrAPI("POST","api/?v1/login",b).success(function(e){var d=JSON.parse(e);if(d.data==true){local("set","message","Welcome|Login Successful|success");location.reload()}else{if(d.data=="mismatch"){$("div.login-box").unblock({});message("Login Error"," Wrong username/email/password combo",activeInfo.settings.notifications.position,"#FFF","warning","10000");console.error("Organizr Function: Login failed - wrong username/email/password")}else{if(d.data=="lockout"){$("div.login-box").block({message:'<h5><i class="fa fa-close"></i> Locked Out!</h4>',css:{color:"#fff",border:"1px solid #e91e63",backgroundColor:"#f44336"}});message("Login Error"," You have been Locked out",activeInfo.settings.notifications.position,"#FFF","error","10000");console.error("Organizr Function: Login failed - User has been locked out");setTimeout(function(){local("r","loggingIn");location.reload()},10000)}else{if(d.data=="2FA"){$("div.login-box").unblock({});$("#tfa-div").removeClass("hidden");$("#loginform [name=tfaCode]").focus()}else{if(d.data=="2FA-incorrect"){$("div.login-box").unblock({});$("#tfa-div").removeClass("hidden");$("#loginform [name=tfaCode]").focus();message("Login Error",d.data,activeInfo.settings.notifications.position,"#FFF","warning","10000")}else{$("div.login-box").unblock({});message("Login Error",d.data,activeInfo.settings.notifications.position,"#FFF","warning","10000");console.error("Organizr Function: Login failed")}}}}}local("r","loggingIn")}).fail(function(d){$("div.login-box").unblock({});message("Login Error","API Connection Failed",activeInfo.settings.notifications.position,"#FFF","warning","10000");console.error("Organizr Function: API Connection Failed");local("r","loggingIn")})}});$(document).on("click",".unlockButton",function(b){b.preventDefault;var a={password:$("#unlockPassword").val()};organizrAPI("POST","api/?v1/unlock",a).success(function(d){var c=JSON.parse(d);console.log(c);if(c.data==true){location.reload()}else{if(c.data=="Password Incorrect"){message("Login Error"," Wrong password",activeInfo.settings.notifications.position,"#FFF","warning","10000");console.error("Organizr Function: Login failed - wrong password")}else{message("Login Error",c.data,activeInfo.settings.notifications.position,"#FFF","warning","10000");console.error("Organizr Function: Login failed")}}}).fail(function(c){console.error("Organizr Function: Login Failed")})});$(document).on("click",".register-button",function(b){b.preventDefault;var a=$("#registerForm").serializeArray();organizrAPI("POST","api/?v1/register",a).success(function(d){var c=JSON.parse(d);console.log(c);if(c.data==true){location.reload()}else{if(c.data=="mismatch"){message("Registration Error"," Wrong Registration Password",activeInfo.settings.notifications.position,"#FFF","warning","10000");console.error("Organizr Function: Registration failed - Wrong Registration Password")}else{if(c.data=="username taken"){message("Registration Error"," Registration Error - Username/Email Taken",activeInfo.settings.notifications.position,"#FFF","warning","10000");console.error("Organizr Function: Registration Failed - Username/Email Taken")}}}}).fail(function(c){console.error("Organizr Function: Login Failed")})});$(document).on("click",".reset-button",function(c){c.preventDefault;var a=$("#recover-input").val();if(a!==""){var b={email:a};organizrAPI("POST","api/?v1/recover",b).success(function(e){var d=JSON.parse(e);if(d.data==true){message("Recover Password"," Email Sent",activeInfo.settings.notifications.position,"#FFF","success","10000");$("#leave-recover").trigger("click")}else{if(d.data=="an error occured"){message("Recover Error"," User Error",activeInfo.settings.notifications.position,"#FFF","warning","10000");console.error("Organizr Function: Recover failed - Wrong Registration Password")}else{if(d.data=="username taken"){message("Recover Error"," Registration Error - Username/Email Taken",activeInfo.settings.notifications.position,"#FFF","warning","10000");console.error("Organizr Function: Recover Failed - Username/Email Taken")}}}}).fail(function(d){console.error("Organizr Function: Login Failed")})}else{message("Recover Error","Enter Email",activeInfo.settings.notifications.position,"#FFF","warning","10000")}});$(document).on("click",".open-close",function(){$("body").toggleClass("show-sidebar")});$(document).on("click",".editGroupButton",function(){$("#edit-group-form [name=groupName]").val($(this).parent().parent().attr("data-group"));$("#edit-group-form [name=id]").val($(this).parent().parent().attr("data-id"));$("#edit-group-form [name=groupImage]").val($(this).parent().parent().attr("data-image"));$("#edit-group-form [name=oldGroupName]").val($(this).parent().parent().attr("data-group"))});$(document).on("click",".editGroup",function(){var a={action:"editUserGroup",api:"api/?v1/settings/user/manage/groups",id:$("#edit-group-form [name=id]").val(),groupName:$("#edit-group-form [name=groupName]").val(),groupImage:$("#edit-group-form [name=groupImage]").val(),oldGroupName:$("#edit-group-form [name=oldGroupName]").val(),messageTitle:"",messageBody:"Edited User Group "+$("#edit-group-form [name=groupName]").val(),error:"Organizr Function: User Group API Connection Failed"};if(typeof a.id=="undefined"||a.id==""){message("New Group Error"," Could not get Group ID",activeInfo.settings.notifications.position,"#FFF","error","5000")}if(typeof a.groupName=="undefined"||a.groupName==""){message("New Group Error"," Please set a Group Name",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(typeof a.groupImage=="undefined"||a.groupImage==""){message("New Group Error"," Please set a Group Image",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(a.id!==""&&a.groupName!==""&&a.groupImage!==""){var b=$.Callbacks();b.add(buildGroupManagement);settingsAPI(a,b);clearForm("#edit-group-form");$.magnificPopup.close()}});$(document).on("click",".changeDefaultGroup",function(){var a={action:"changeDefaultGroup",api:"api/?v1/settings/user/manage/groups",id:$(this).parent().parent().attr("data-id"),oldGroupID:$("#manageGroupTable").find("tr[data-default=true]").attr("data-group-id"),oldGroupName:$("#manageGroupTable").find("tr[data-default=true]").attr("data-group"),newGroupID:$(this).parent().parent().attr("data-group-id"),newGroupName:$(this).parent().parent().attr("data-group"),messageTitle:"",messageBody:"Changed Default Group to "+$(this).parent().parent().attr("data-group"),error:"Organizr Function: User Group API Connection Failed"};var b=$.Callbacks();b.add(buildGroupManagement);settingsAPI(a,b)});$(document).on("click",".deleteUserGroup",function(){var a=$(this);swal({title:window.lang.translate("Delete ")+a.parent().parent().attr("data-group")+"?",icon:"warning",buttons:{cancel:window.lang.translate("No"),confirm:window.lang.translate("Yes")},dangerMode:true,confirmButtonColor:"#DD6B55"}).then(function(d){if(d){var b={action:"deleteUserGroup",api:"api/?v1/settings/user/manage/groups",id:a.parent().parent().attr("data-id"),groupID:a.parent().parent().attr("data-group-id"),groupName:a.parent().parent().attr("data-group"),messageTitle:"",messageBody:"Deleted User Group "+a.parent().parent().attr("data-group"),error:"Organizr Function: User Group API Connection Failed"};var c=$.Callbacks();c.add(buildGroupManagement);settingsAPI(b,c)}})});$(document).on("click",".addNewGroup",function(){var a={action:"addUserGroup",api:"api/?v1/settings/user/manage/groups",newGroupID:parseInt($("#manageGroupTable").find("tr[data-group-id]:nth-last-child(2)").attr("data-group-id"))+1,newGroupName:$("#new-group-form [name=groupName]").val(),newGroupImage:$("#new-group-form [name=groupImage]").val(),messageTitle:"",messageBody:"Created User Group "+$("#new-group-form [name=groupName]").val(),error:"Organizr Function: User Group API Connection Failed"};if(typeof a.newGroupID=="undefined"||a.newGroupID==""){message("New Group Error"," Could not get next Group ID",activeInfo.settings.notifications.position,"#FFF","error","5000")}if(typeof a.newGroupName=="undefined"||a.newGroupName==""){message("New Group Error"," Please set a Group Name",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(typeof a.newGroupImage=="undefined"||a.newGroupImage==""){message("New Group Error"," Please set a Group Image",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(a.newGroupID!==""&&a.newGroupName!==""&&a.newGroupImage!==""){var b=$.Callbacks();b.add(buildGroupManagement);settingsAPI(a,b);clearForm("#new-group-form");$.magnificPopup.close()}});$(document).on("click",".addNewUser",function(){var a={action:"addNewUser",api:"api/?v1/settings/user/manage/users",username:$("#new-user-form [name=username]").val(),email:$("#new-user-form [name=email]").val(),password:$("#new-user-form [name=password]").val(),messageTitle:"",messageBody:"Added New User: "+$("#new-user-form [name=username]").val(),error:"Organizr Function: User API Connection Failed"};if(typeof a.username=="undefined"||a.username==""){message("New User Error"," Please set a Username",activeInfo.settings.notifications.position,"#FFF","error","5000")}if(typeof a.email=="undefined"||a.email==""){message("New User Error"," Please set an Email",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(typeof a.password=="undefined"||a.password==""){message("New User Error"," Please set a Password",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(a.username!==""&&a.email!==""&&a.password!==""){var b=$.Callbacks();b.add(buildUserManagement);settingsAPI(a,b);clearForm("#new-user-form");$.magnificPopup.close()}});$(document).on("click",".editUserButton",function(){$("#edit-user-form [name=username]").val($(this).parent().parent().attr("data-username"));$("#edit-user-form [name=id]").val($(this).parent().parent().attr("data-id"));$("#edit-user-form [name=email]").val($(this).parent().parent().attr("data-email"))});$(document).on("click",".editUserAdmin",function(){var a={action:"editUser",api:"api/?v1/settings/user/manage/users",id:$("#edit-user-form [name=id]").val(),username:$("#edit-user-form [name=username]").val(),email:$("#edit-user-form [name=email]").val(),password:$("#edit-user-form [name=password]").val(),messageTitle:"",messageBody:"Edited User "+$("#edit-user-form [name=username]").val(),error:"Organizr Function: API Connection Failed"};if(typeof a.id=="undefined"||a.id==""){message("Edit User Error"," Could not get User ID",activeInfo.settings.notifications.position,"#FFF","error","5000")}if(typeof a.username=="undefined"||a.username==""){message("Edit User Error"," Please set a Username",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(typeof a.email=="undefined"||a.email==""){message("Edit User Error"," Please set a User Email",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(a.password!==""&&a.password!==$("#edit-user-form [name=password2]").val()){message("Edit User Error"," Passwords do not match!",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(a.id!==""&&a.username!==""&&a.email!==""){var b=$.Callbacks();b.add(buildUserManagement);settingsAPI(a,b);clearForm("#edit-user-form");$.magnificPopup.close()}});$(document).on("change",".userGroupSelect",function(){var a={action:"changeGroup",api:"api/?v1/settings/user/manage/users",id:$(this).parent().parent().attr("data-id"),username:$(this).parent().parent().attr("data-username"),oldGroup:$(this).parent().parent().attr("data-group"),newGroupID:$(this).find("option:selected").val(),newGroupName:$(this).find("option:selected").text(),messageTitle:"",messageBody:"User Info updated for "+$(this).parent().parent().attr("data-username"),error:"Organizr Function: User API Connection Failed"};var b=$.Callbacks();b.add(buildUserManagement);settingsAPI(a,b)});$(document).on("click",".deleteUser",function(){var a=$(this);swal({title:window.lang.translate("Delete ")+a.parent().parent().attr("data-username")+"?",icon:"warning",buttons:{cancel:window.lang.translate("No"),confirm:window.lang.translate("Yes")},dangerMode:true,confirmButtonColor:"#DD6B55"}).then(function(d){if(d){var b={action:"deleteUser",api:"api/?v1/settings/user/manage/users",id:a.parent().parent().attr("data-id"),username:a.parent().parent().attr("data-username"),messageTitle:"",messageBody:window.lang.translate("Deleted User")+": "+a.parent().parent().attr("data-username"),error:"Organizr Function: User API Connection Failed"};var c=$.Callbacks();c.add(buildUserManagement);settingsAPI(b,c)}})});$(document).on("change",".tabGroupSelect",function(){var a={action:"changeGroup",api:"api/?v1/settings/tab/editor/tabs",id:$(this).parent().parent().attr("data-id"),tab:$(this).parent().parent().attr("data-name"),oldGroupID:$(this).parent().parent().attr("data-group-id"),newGroupID:$(this).find("option:selected").val(),newGroupName:$(this).find("option:selected").text(),messageTitle:"",messageBody:"Tab Info updated for "+$(this).parent().parent().attr("data-name"),error:"Organizr Function: Tab API Connection Failed"};var b=$.Callbacks();b.add(buildTabEditor);settingsAPI(a,b)});$(document).on("change",".tabCategorySelect",function(){var a={action:"changeCategory",api:"api/?v1/settings/tab/editor/tabs",id:$(this).parent().parent().attr("data-id"),tab:$(this).parent().parent().attr("data-name"),newCategoryID:$(this).find("option:selected").val(),newCategoryName:$(this).find("option:selected").text(),messageTitle:"",messageBody:"Tab Info updated for "+$(this).parent().parent().attr("data-name"),error:"Organizr Function: Tab API Connection Failed"};var b=$.Callbacks();b.add(buildTabEditor);settingsAPI(a,b)});$(document).on("change",".tabTypeSelect",function(){var a={action:"changeType",api:"api/?v1/settings/tab/editor/tabs",id:$(this).parent().parent().attr("data-id"),tab:$(this).parent().parent().attr("data-name"),newTypeID:$(this).find("option:selected").val(),newTypeName:$(this).find("option:selected").text(),messageTitle:"",messageBody:"Tab Info updated for "+$(this).parent().parent().attr("data-name"),error:"Organizr Function: Tab API Connection Failed"};var b=$.Callbacks();b.add(buildTabEditor);settingsAPI(a,b)});$(document).on("change",".enabledSwitch",function(){var a={action:"changeEnabled",api:"api/?v1/settings/tab/editor/tabs",id:$(this).parent().parent().attr("data-id"),tab:$(this).parent().parent().attr("data-name"),tabEnabled:$(this).prop("checked")?1:0,tabEnabledWord:$(this).prop("checked")?"On":"Off",messageTitle:"",messageBody:"Tab Info updated for "+$(this).parent().parent().attr("data-name"),error:"Organizr Function: Tab API Connection Failed"};var b=$.Callbacks();b.add(buildTabEditor);settingsAPI(a,b)});$(document).on("change",".splashSwitch",function(){var a={action:"changeSplash",api:"api/?v1/settings/tab/editor/tabs",id:$(this).parent().parent().attr("data-id"),tab:$(this).parent().parent().attr("data-name"),tabSplash:$(this).prop("checked")?1:0,tabSplashWord:$(this).prop("checked")?"On":"Off",messageTitle:"",messageBody:"Tab Info updated for "+$(this).parent().parent().attr("data-name"),error:"Organizr Function: Tab API Connection Failed"};var b=$.Callbacks();b.add(buildTabEditor);settingsAPI(a,b)});$(document).on("change",".pingSwitch",function(){var a={action:"changePing",api:"api/?v1/settings/tab/editor/tabs",id:$(this).parent().parent().attr("data-id"),tab:$(this).parent().parent().attr("data-name"),tabPing:$(this).prop("checked")?1:0,tabPingWord:$(this).prop("checked")?"On":"Off",messageTitle:"",messageBody:"Tab Info updated for "+$(this).parent().parent().attr("data-name"),error:"Organizr Function: Tab API Connection Failed"};var b=$.Callbacks();b.add(buildTabEditor);settingsAPI(a,b)});$(document).on("change",".preloadSwitch",function(){var a={action:"changePreload",api:"api/?v1/settings/tab/editor/tabs",id:$(this).parent().parent().attr("data-id"),tab:$(this).parent().parent().attr("data-name"),tabPreload:$(this).prop("checked")?1:0,tabPreloadWord:$(this).prop("checked")?"On":"Off",messageTitle:"",messageBody:"Tab Info updated for "+$(this).parent().parent().attr("data-name"),error:"Organizr Function: Tab API Connection Failed"};var b=$.Callbacks();b.add(buildTabEditor);settingsAPI(a,b)});$(document).on("change",".defaultSwitch",function(){var a={action:"changeDefault",api:"api/?v1/settings/tab/editor/tabs",id:$(this).parent().parent().parent().attr("data-id"),tab:$(this).parent().parent().parent().attr("data-name"),messageTitle:"",messageBody:"Changed Default Tab to: "+$(this).parent().parent().parent().attr("data-name"),error:"Organizr Function: Tab API Connection Failed"};var b=$.Callbacks();b.add(buildTabEditor);settingsAPI(a,b)});$(document).on("click",".deleteTab",function(){var a=$(this);swal({title:window.lang.translate("Delete ")+a.parent().parent().attr("data-name")+"?",icon:"warning",buttons:{cancel:window.lang.translate("No"),confirm:window.lang.translate("Yes")},dangerMode:true,confirmButtonColor:"#DD6B55"}).then(function(d){if(d){var b={action:"deleteTab",api:"api/?v1/settings/tab/editor/tabs",id:a.parent().parent().attr("data-id"),tab:a.parent().parent().attr("data-name"),messageTitle:"",messageBody:window.lang.translate("Deleted Tab")+": "+a.parent().parent().attr("data-name"),error:"Organizr Function: Tab Editor API Connection Failed"};var c=$.Callbacks();c.add(buildTabEditor);settingsAPI(b,c)}})});function convertMsToMinutes(a){if(a===false||a===0||a==="0"){return 0}else{return(a/1000)/60}}function convertMinutesToMs(a){if(a===false||a===0||a==="0"){return 0}else{return(a*1000)*60}}$(document).on("click",".editTabButton",function(){$("#edit-tab-form [name=tabName]").val($(this).parent().parent().attr("data-name"));$("#originalTabName").html($(this).parent().parent().attr("data-name"));$("#edit-tab-form [name=tabURL]").val($(this).parent().parent().attr("data-url"));$("#edit-tab-form [name=tabLocalURL]").val($(this).parent().parent().attr("data-local-url"));$("#edit-tab-form [name=pingURL]").val($(this).parent().parent().attr("data-ping-url"));$("#edit-tab-form [name=tabImage]").val($(this).parent().parent().attr("data-image"));$("#edit-tab-form [name=id]").val($(this).parent().parent().attr("data-id"));$("#edit-tab-form [name=tabActionTime]").val(convertMsToMinutes($(this).parent().parent().attr("data-tab-action-time")));$("#edit-tab-form [name=tabActionType]").val($(this).parent().parent().attr("data-tab-action-type"));if($(this).parent().parent().attr("data-url").indexOf("/?v")>0){$("#edit-tab-form [name=tabURL]").prop("disabled","true")}else{$("#edit-tab-form [name=tabURL]").prop("disabled",null)}});$(document).on("click",".editTab",function(){var a=$("#originalTabName").html();var b={action:"editTab",api:"api/?v1/settings/tab/editor/tabs",id:$("#edit-tab-form [name=id]").val(),tabName:$("#edit-tab-form [name=tabName]").val(),tabImage:$("#edit-tab-form [name=tabImage]").val(),tabURL:$("#edit-tab-form [name=tabURL]").val(),tabLocalURL:$("#edit-tab-form [name=tabLocalURL]").val(),pingURL:$("#edit-tab-form [name=pingURL]").val(),tabActionTime:convertMinutesToMs($("#edit-tab-form [name=tabActionTime]").val()),tabActionType:$("#edit-tab-form [name=tabActionType]").val(),messageTitle:"",messageBody:"Edited Tab "+$("#edit-tab-form [name=tabName]").val(),error:"Organizr Function: Tab Editor API Connection Failed"};if(typeof b.id=="undefined"||b.id==""){message("Edit Tab Error"," Could not get Tab ID",activeInfo.settings.notifications.position,"#FFF","error","5000")}if(typeof b.tabName=="undefined"||b.tabName==""){message("Edit Tab Error"," Please set a Tab Name",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(typeof b.tabImage=="undefined"||b.tabImage==""){message("Edit Tab Error"," Please set a Tab Image",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if((typeof b.tabURL=="undefined"||b.tabURL=="")&&(typeof b.tabLocalURL=="undefined"||b.tabLocalURL=="")){message("Edit Tab Error"," Please set a Tab URL or Local URL",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(checkIfTabNameExists(b.tabName)&&a!==b.tabName){message("Edit Tab Error"," Tab name already used",activeInfo.settings.notifications.position,"#FFF","warning","5000");return false}if(b.id!==""&&b.tabName!==""&&b.tabImage!==""){var c=$.Callbacks();c.add(buildTabEditor);settingsAPI(b,c);clearForm("#edit-tab-form");$.magnificPopup.close()}});$(document).on("click",".addNewTab",function(){var a={action:"addNewTab",api:"api/?v1/settings/tab/editor/tabs",tabOrder:parseInt($("#tabEditorTable").find("tr[data-order]").last().attr("data-order"))+1,tabName:$("#new-tab-form [name=tabName]").val(),tabImage:$("#new-tab-form [name=tabImage]").val(),tabURL:$("#new-tab-form [name=tabURL]").val(),tabLocalURL:$("#new-tab-form [name=tabLocalURL]").val(),pingURL:$("#new-tab-form [name=pingURL]").val(),tabActionTime:convertMinutesToMs($("#new-tab-form [name=tabActionTime]").val()),tabActionType:$("#new-tab-form [name=tabActionType]").val(),tabGroupID:1,tabEnabled:0,tabDefault:0,tabType:1,messageTitle:"Created Tab "+$("#new-tab-form [name=tabName]").val(),messageBody:'Please <a href="javascript:void(0)" onclick="window.location.reload(false);">RELOAD</a> page to update',error:"Organizr Function: Tab API Connection Failed"};if(typeof a.tabOrder=="undefined"||a.tabOrder==""){message("New Tab Error"," Could not get next Group ID",activeInfo.settings.notifications.position,"#FFF","error","5000")}if(typeof a.tabName=="undefined"||a.tabName==""){message("New Tab Error"," Please set a Tab Name",activeInfo.settings.notifications.position,"#FFF","error","5000")}if((typeof a.tabURL=="undefined"||a.tabURL=="")&&(typeof a.tabLocalURL=="undefined"||a.tabLocalURL=="")){message("New Tab Error"," Please set a Tab URL or Local URL",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(typeof a.tabImage=="undefined"||a.tabImage==""){message("New Tab Error"," Please set a Tab Image",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(checkIfTabNameExists(a.tabName)){message("New Tab Error"," Tab name already used",activeInfo.settings.notifications.position,"#FFF","warning","5000");return false}if(a.tabOrder!==""&&a.tabName!==""&&(a.tabURL!==""||a.tabLocalURL!=="")&&a.tabImage!==""){var b=$.Callbacks();b.add(buildTabEditor);settingsAPI(a,b);clearForm("#new-tab-form");$.magnificPopup.close()}});$(document).on("click",".addNewCategory",function(){var b=[];$($("#categoryEditorTable").find("tr[data-category-id]")).each(function(){b.push($(this).attr("data-category-id"))});var a={action:"addNewCategory",api:"api/?v1/settings/tab/editor/categories",categoryOrder:parseInt($("#categoryEditorTable").find("tr[data-order]").last().attr("data-order"))+1,categoryName:$("#new-category-form [name=name]").val(),categoryImage:$("#new-category-form [name=image]").val(),categoryID:Math.max.apply(null,b)+1,categoryDefault:0,messageTitle:"",messageBody:"Created Category "+$("#new-category-form [name=name]").val(),error:"Organizr Function: API Connection Failed"};console.log(a);if(typeof a.categoryID=="undefined"||a.categoryID==""){message("New Category Error"," Could not get next Category ID",activeInfo.settings.notifications.position,"#FFF","error","5000")}if(typeof a.categoryName=="undefined"||a.categoryName==""){message("New Category Error"," Please set a Category Name",activeInfo.settings.notifications.position,"#FFF","error","5000")}if(typeof a.categoryOrder=="undefined"||a.categoryOrder==""){message("New Category Error"," Could not get Category Order",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(typeof a.categoryImage=="undefined"||a.categoryImage==""){message("New Category Error"," Please set a Category Image",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(a.categoryID!==""&&a.categoryName!==""&&a.categoryOrder!==""&&a.categoryImage!==""){var c=$.Callbacks();c.add(buildCategoryEditor);settingsAPI(a,c);clearForm("#new-category-form");$.magnificPopup.close()}});$(document).on("click",".deleteCategory",function(){var a=$(this);swal({title:window.lang.translate("Delete ")+a.parent().parent().attr("data-name")+"?",icon:"warning",buttons:{cancel:window.lang.translate("No"),confirm:window.lang.translate("Yes")},dangerMode:true,confirmButtonColor:"#DD6B55"}).then(function(d){if(d){var b={action:"deleteCategory",api:"api/?v1/settings/tab/editor/categories",id:a.parent().parent().attr("data-id"),category:a.parent().parent().attr("data-name"),messageTitle:"",messageBody:window.lang.translate("Deleted Category")+": "+a.parent().parent().attr("data-name"),error:"Organizr Function: API Connection Failed"};var c=$.Callbacks();c.add(buildCategoryEditor);settingsAPI(b,c)}})});$(document).on("click",".editCategoryButton",function(){$("#edit-category-form [name=name]").val($(this).parent().parent().attr("data-name"));$("#edit-category-form [name=image]").val($(this).parent().parent().attr("data-image"));$("#edit-category-form [name=id]").val($(this).parent().parent().attr("data-id"))});$(document).on("click",".editCategory",function(){var a={action:"editCategory",api:"api/?v1/settings/tab/editor/categories",id:$("#edit-category-form [name=id]").val(),name:$("#edit-category-form [name=name]").val(),image:$("#edit-category-form [name=image]").val(),messageTitle:"",messageBody:"Edited Category "+$("#edit-category-form [name=name]").val(),error:"Organizr Function: API Connection Failed"};console.log(a);if(typeof a.id=="undefined"||a.id==""){message("Edit Tab Error"," Could not get Tab ID",activeInfo.settings.notifications.position,"#FFF","error","5000")}if(typeof a.name=="undefined"||a.name==""){message("Edit Tab Error"," Please set a Tab Name",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(typeof a.image=="undefined"||a.image==""){message("Edit Tab Error"," Please set a Tab Image",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(a.id!==""&&a.name!==""&&a.image!==""){var b=$.Callbacks();b.add(buildCategoryEditor);settingsAPI(a,b);clearForm("#edit-category-form");$.magnificPopup.close()}});$(document).on("click",".changeDefaultCategory",function(){var a={action:"changeDefault",api:"api/?v1/settings/tab/editor/categories",id:$(this).parent().parent().attr("data-id"),oldCategoryName:$("#categoryEditorTable").find("tr[data-default=true]").attr("data-name"),newCategoryName:$(this).parent().parent().attr("data-name"),messageTitle:"",messageBody:"Changed Default Category to "+$(this).parent().parent().attr("data-name"),error:"Organizr Function: API Connection Failed"};var b=$.Callbacks();b.add(buildCategoryEditor);settingsAPI(a,b)});$(document).on("click",".saveCss",function(){$(".cssTextarea").val(cssEditor.getValue()).trigger("change")});$(document).on("click",".saveThemeCss",function(){$(".cssThemeTextarea").val(cssThemeEditor.getValue()).trigger("change")});$(document).on("click",".saveJava",function(){$(".javaTextarea").val(javaEditor.getValue()).trigger("change")});$(document).on("click",".saveThemeJava",function(){$(".javaThemeTextarea").val(javaThemeEditor.getValue()).trigger("change")});$(document).on("click",".savecustomHTMLoneTextarea",function(){$(".customHTMLoneTextarea").val(customHTMLoneEditor.getValue()).trigger("change")});$(document).on("click",".savecustomHTMLtwoTextarea",function(){$(".customHTMLtwoTextarea").val(customHTMLtwoEditor.getValue()).trigger("change")});$(document).on("focusout","input.pick-a-color",function(c){var a=$(this).attr("data-original");var b=$(this).val();if((a!==b)&&(b!=="#987654")&&b!==""){$(this).change();$(this).attr("data-original",b)}else{if(b==""){$(this).attr("style","")}}});$(document).on("change keydown",".addFormTick :input",function(c){$(this).attr("data-changed",true);$(this).closest(".form-group").addClass("has-success");var b=$(this).closest("form").attr("id");$("#"+b+"-save").removeClass("hidden");switch($(this).attr("type")){case"switch":case"checkbox":var a=$(this).prop("checked")?true:false;break;default:var a=$(this).val()}if($(this).hasClass("themeChanger")){changeTheme(a)}if($(this).hasClass("styleChanger")){changeStyle(a)}if($(this).hasClass("notifyChanger")){activeInfo.settings.notifications.backbone=a;defineNotification()}if($(this).hasClass("notifyPositionChanger")){activeInfo.settings.notifications.position=a}if($(this).hasClass("authDebug")){activeInfo.settings.misc.authDebug=a}});$(document).on("click",".deleteImage",function(){var a=$(this);swal({title:window.lang.translate("Delete ")+a.attr("data-image-name")+"?",icon:"warning",buttons:{cancel:window.lang.translate("No"),confirm:window.lang.translate("Yes")},dangerMode:true,confirmButtonColor:"#DD6B55"}).then(function(d){if(d){var b={action:"deleteImage",api:"api/?v1/settings/image/manager/view",imageName:a.attr("data-image-name"),imagePath:a.attr("data-image-path"),messageTitle:"",messageBody:window.lang.translate("Deleted Image")+": "+a.attr("data-image-name"),error:"Organizr Function: User API Connection Failed"};var c=$.Callbacks();c.add(buildImageManagerView);settingsAPI(b,c)}})});$(document).on("click",".reload",function(){location.reload()});$(document).on("click",".enablePlugin",function(){var a={action:"enable",api:"api/?v1/settings/plugins/list",name:$(this).attr("data-plugin-name"),configName:$(this).attr("data-config-name"),messageTitle:"",messageBody:"Enabling "+$(this).attr("data-plugin-name"),error:"Organizr Function: API Connection Failed"};var b=$.Callbacks();settingsAPI(a,b);ajaxloader(".content-wrap","in");setTimeout(function(){buildPlugins();ajaxloader()},3000)});$(document).on("click",".disablePlugin",function(){var a=$(this);swal({title:window.lang.translate("Disable")+" "+a.attr("data-plugin-name")+"?",icon:"warning",buttons:{cancel:window.lang.translate("No"),confirm:window.lang.translate("Yes")},dangerMode:true,confirmButtonColor:"#DD6B55"}).then(function(d){if(d){var b={action:"disable",api:"api/?v1/settings/plugins/list",name:a.attr("data-plugin-name"),configName:a.attr("data-config-name"),messageTitle:"",messageBody:"Disabling "+a.attr("data-plugin-name"),error:"Organizr Function: API Connection Failed"};var c=$.Callbacks();settingsAPI(b,c);ajaxloader(".content-wrap","in");setTimeout(function(){buildPlugins();ajaxloader()},3000)}})});$(document).on("change","#authSelect, #authBackendSelect",function(a){changeAuth()});$(document).on("click",".getSSOPlexToken",function(){$(".ssoPlexTokenMessage").text("Grabbing Token");$(".ssoPlexTokenHeader").addClass("panel-info").removeClass("panel-warning").removeClass("panel-danger");var a=$("#sso-plex-token-form [name=username]").val().trim();var b=$("#sso-plex-token-form [name=password]").val().trim();if((b!=="")&&(b!=="")){$.ajax({type:"POST",headers:{"X-Plex-Product":"Organizr","X-Plex-Version":"2.0","X-Plex-Client-Identifier":"01010101-10101010"},url:"https://plex.tv/users/sign_in.json",data:{"user[login]":a,"user[password]":b,force:true},cache:false,async:true,complete:function(e,d){var c=$.parseJSON(e.responseText);if(e.status===201){$(".ssoPlexTokenMessage").text(e.statusText);$(".ssoPlexTokenHeader").addClass("panel-success").removeClass("panel-info").removeClass("panel-warning").removeClass("panel-danger");$("#sso-form [name=plexToken]").val(c.user.authToken);$("#sso-form [name=plexToken]").change()}else{$(".ssoPlexTokenMessage").text(e.statusText);$(".ssoPlexTokenHeader").addClass("panel-danger").removeClass("panel-info").removeClass("panel-warning")}}})}else{$(".ssoPlexTokenMessage").text("Enter Username and Password");$(".ssoPlexTokenHeader").addClass("panel-warning").removeClass("panel-info").removeClass("panel-danger")}});$(document).on("click",".getPlexMachineSSO",function(){var a=$("#sso-form [name=plexToken]").val().trim();if(a!==""){$(".ssoPlexMachineMessage").text("Grabbing List");$(".ssoPlexMachineHeader").addClass("panel-info").removeClass("panel-warning").removeClass("panel-danger");$.ajax({type:"GET",headers:{"X-Plex-Product":"Organizr","X-Plex-Version":"2.0","X-Plex-Client-Identifier":"01010101-10101010","X-Plex-Token":a},url:"https://plex.tv/pms/servers.xml",cache:false,async:true,complete:function(e,c){var b=$.parseXML(e.responseText);if(e.status===200){$(".ssoPlexMachineMessage").text("Choose Plex Server");$(".ssoPlexMachineHeader").addClass("panel-success").removeClass("panel-info").removeClass("panel-warning");var d='<option lang="en">Choose Plex Machine</option>';$("Server",b).each(function(){if($(this).attr("owned")==1){var g=$(this).attr("name");var h=$(this).attr("machineIdentifier");g=g+" ["+h+"]";d+='<option value="'+h+'">'+g+"</option>"}});var f='<select class="form-control" id="ssoPlexMachineSelector" data-type="select">'+d+"</select>";$(".ssoPlexMachineListing").html(f)}else{$(".ssoPlexTokenMessage").text(e.statusText);$(".ssoPlexTokenHeader").addClass("panel-danger").removeClass("panel-info").removeClass("panel-warning")}}})}else{$(".ssoPlexMachineMessage").text("Plex Token Needed");$(".ssoPlexMachineHeader").addClass("panel-warning").removeClass("panel-info").removeClass("panel-danger")}});$(document).on("change","#ssoPlexMachineSelector",function(a){$("#sso-form [name=plexID]").val($(this).val());$("#sso-form [name=plexID]").change()});$(document).on("click",".getauthPlexToken",function(){$(".authPlexTokenMessage").text("Grabbing Token");$(".authPlexTokenHeader").addClass("panel-info").removeClass("panel-warning").removeClass("panel-danger");var a=$("#auth-plex-token-form [name=username]").val().trim();var b=$("#auth-plex-token-form [name=password]").val().trim();if((b!=="")&&(b!=="")){$.ajax({type:"POST",headers:{"X-Plex-Product":"Organizr","X-Plex-Version":"2.0","X-Plex-Client-Identifier":"01010101-10101010"},url:"https://plex.tv/users/sign_in.json",data:{"user[login]":a,"user[password]":b,force:true},cache:false,async:true,complete:function(e,d){var c=$.parseJSON(e.responseText);if(e.status===201){$(".authPlexTokenMessage").text(e.statusText);$(".authPlexTokenHeader").addClass("panel-success").removeClass("panel-info").removeClass("panel-warning").removeClass("panel-danger");$("#settings-main-form [name=plexToken]").val(c.user.authToken);$("#settings-main-form [name=plexToken]").change()}else{$(".authPlexTokenMessage").text(e.statusText);$(".authPlexTokenHeader").addClass("panel-danger").removeClass("panel-info").removeClass("panel-warning")}}})}else{$(".authPlexTokenMessage").text("Enter Username and Password");$(".authPlexTokenHeader").addClass("panel-warning").removeClass("panel-info").removeClass("panel-danger")}});$(document).on("click",".getPlexMachineAuth",function(){var a=$("#settings-main-form [name=plexToken]").val().trim();if(a!==""){$(".authPlexMachineMessage").text("Grabbing List");$(".authPlexMachineHeader").addClass("panel-info").removeClass("panel-warning").removeClass("panel-danger");$.ajax({type:"GET",headers:{"X-Plex-Product":"Organizr","X-Plex-Version":"2.0","X-Plex-Client-Identifier":"01010101-10101010","X-Plex-Token":a},url:"https://plex.tv/pms/servers.xml",cache:false,async:true,complete:function(e,c){var b=$.parseXML(e.responseText);if(e.status===200){$(".authPlexMachineMessage").text("Choose Plex Server");$(".authPlexMachineHeader").addClass("panel-success").removeClass("panel-info").removeClass("panel-warning");var d='<option lang="en">Choose Plex Machine</option>';$("Server",b).each(function(){if($(this).attr("owned")==1){var g=$(this).attr("name");var h=$(this).attr("machineIdentifier");g=g+" ["+h+"]";d+='<option value="'+h+'">'+g+"</option>"}});var f='<select class="form-control" id="authPlexMachineSelector" data-type="select">'+d+"</select>";$(".authPlexMachineListing").html(f)}else{$(".authPlexTokenMessage").text(e.statusText);$(".authPlexTokenHeader").addClass("panel-danger").removeClass("panel-info").removeClass("panel-warning")}}})}else{$(".authPlexMachineMessage").text("Plex Token Needed");$(".authPlexMachineHeader").addClass("panel-warning").removeClass("panel-info").removeClass("panel-danger")}});$(document).on("change","#authPlexMachineSelector",function(a){$("#settings-main-form [name=plexID]").val($(this).val());$("#settings-main-form [name=plexID]").change()});$(document).on("click",".closeErrorPage",function(){$(".error-page").html("");$(".error-page").fadeOut()});$(document).on("click",".testPath",function(){var a=$("#form-location").val();if(typeof a=="undefined"||a==""){message("Path Error"," Please enter a path for DB",activeInfo.settings.notifications.position,"#FFF","warning","10000")}else{organizrAPI("POST","api/?v1/wizard_path",{path:a}).success(function(c){var b=JSON.parse(c);console.log(b);if(b.data==true){message("Path"," Path is good to go",activeInfo.settings.notifications.position,"#FFF","success","10000")}else{message("Path Error"," Path is not writable",activeInfo.settings.notifications.position,"#FFF","warning","10000")}}).fail(function(b){console.error("Organizr Function: Connection Failed")})}});$(document).on({mouseenter:function(){$(this).find(".progress").toggleClass("progress-lg");$(this).find(".progress").find("span").toggleClass("hidden");$(this).find(".white-box").toggleClass("nowPlayingHover")},mouseleave:function(){$(this).find(".progress").toggleClass("progress-lg");$(this).find(".progress").find("span").toggleClass("hidden");$(this).find(".white-box").toggleClass("nowPlayingHover")}},".nowPlayingItem");$(document).on("click",".recent-filter li>a",function(){var c=$(this).attr("data-filter");var b=$(this).attr("server-filter");if(c=="all"){$("."+b+"-recent").find(".recent-item").parent().removeClass("hidden")}else{$("."+b+"-recent").find(".recent-item").parent().removeClass("hidden");$("."+b+"-recent").find(".recent-item:not(."+c+")").parent().addClass("hidden")}var a=$("."+b+"-recent");a.owlCarousel();a.trigger("refresh.owl.carousel");a.trigger("to.owl.carousel",0)});$(document).on("click",".filter-request-result",function(){var a=$(this).attr("data-filter");if(a=="request-result-all"){$(".request-result-item").removeClass("hidden")}else{$(".request-result-item").addClass("hidden");$("."+a).removeClass("hidden")}});$(document).on("click",".playlist-filter li>a",function(){var c=$(this).attr("data-filter");var a=$(this).attr("data-filter")+"-playlist";var d=decodeURI($(this).attr("data-title"));var b=$(this).attr("server-filter");$("."+b+"-playlistTitle").html(d);$("."+b+"-playlist").addClass("hidden");$("."+c+"-playlist").removeClass("hidden");$(".playlist-next").attr("onclick","owlChange('"+a+"','next');");$(".playlist-previous").attr("onclick","owlChange('"+a+"','previous');")});$(document).on("click",".refreshImage",function(d){message(""," Refreshing Image...",activeInfo.settings.notifications.position,"#FFF","success","1000");d.preventDefault;var b=$(this).attr("data-image");var c=$(this).attr("data-type");switch(c){case"nowPlaying":var f=$(this).parent().parent().parent().parent().find(".imageSource");f.attr("src",b);break;case"recent-item":var a=$(this).parent().parent().parent().find(".imageSourceAlt");var f=$(this).parent().parent().parent().parent().find(".imageSource");f.attr("style",'background-image: url("'+b+'");');a.attr("src",b);break;default:}setTimeout(function(){message("Image Refreshed "," Clear Cache Please",activeInfo.settings.notifications.position,"#FFF","success","3000")},1000)});$(document).on("click",".openTab",function(f){if($(this).attr("data-open-tab")==="true"){var d=$(this).attr("data-tab-name");var a=$("#container-"+d);var b=a.children("iframe");if(b.length===1){$("#menu-"+d+" a").trigger("click");b.attr("src",$(this).attr("data-url"))}else{a.attr("data-url",$(this).attr("data-url"));$("#menu-"+d+" a").trigger("click")}}else{var c=$(this).attr("data-url");window.open(c,"_blank")}$.magnificPopup.close()});$(document).on("click",".request-item",function(b){var a=$(this).attr("data-target");$("#link-"+a).trigger("click")});$(document).on("click",".metadata-get",function(f){if($(f.target).hasClass("mdi-refresh")){return}$("#preloader").fadeIn();var b=$(this).attr("data-key");var a=$(this).attr("data-uid");var d=$(this).attr("data-source");switch(d){case"plex":var c="getPlexMetadata";break;case"emby":case"jellyfin":var c="getEmbyMetadata";break;default:}ajaxloader(".content-wrap","in");organizrAPI("POST","api/?v1/homepage/connect",{action:c,key:b}).success(function(g){var e=JSON.parse(g);$("."+a+"-metadata-info").html("");$("."+a+"-metadata-info").html(buildMetadata(e.data,d));$("."+a).trigger("click");$(".metadata-actors").owlCarousel({autoplay:true,slideSpeed:300,paginationSpeed:400,nav:false,dots:false,margin:10,autoWidth:true,items:4})}).fail(function(e){console.error("Organizr Function: API Connection Failed")});ajaxloader();$("#preloader").fadeOut()});$(document).on("click",".downloader",function(d){var b=$(this).attr("data-action");var a=$(this).attr("data-source");var c=$(this).attr("data-target");ajaxloader(".content-wrap","in");organizrAPI("POST","api/?v1/downloader",{action:b,source:a,target:c}).success(function(f){var e=JSON.parse(f);homepageDownloader(a)}).fail(function(e){console.error("Organizr Function: API Connection Failed")});ajaxloader()});$(document).on("click",".testTab",function(){var a=$("#new-tab-form-inputURLNew");if(a.val()==""){message("","Please enter a URL",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(a.val()!==""){var b={url:a.val()};organizrAPI("POST","api/?v1/test/iframe",b).success(function(d){var c=JSON.parse(d);if(c.data==true){$(".tabTestMessage.alert-success").removeClass("hidden");$(".tabTestMessage.alert-danger").addClass("hidden")}else{$(".tabTestMessage.alert-danger").removeClass("hidden");$(".tabTestMessage.alert-success").addClass("hidden")}}).fail(function(c){console.error("Organizr Function: Check Failed")})}});$(document).on("click",".testEditTab",function(){var a=$("#edit-tab-form-inputURL");if(a.val()==""){message("","Please enter a URL",activeInfo.settings.notifications.position,"#FFF","warning","5000")}if(a.val()!==""){var b={url:a.val()};organizrAPI("POST","api/?v1/test/iframe",b).success(function(d){var c=JSON.parse(d);if(c.data==true){$(".tabEditTestMessage.alert-success").removeClass("hidden");$(".tabEditTestMessage.alert-danger").addClass("hidden")}else{$(".tabEditTestMessage.alert-danger").removeClass("hidden");$(".tabEditTestMessage.alert-success").addClass("hidden")}}).fail(function(c){console.error("Organizr Function: Check Failed")})}});$(document).on("click",".newAPIKey",function(){$("#settings-main-form [name=organizrAPI]").val(generateCode());$("#settings-main-form [name=organizrAPI]").change()});$(document).on("click",".purgeLog",function(){var a=$(".swapLog.active").attr("data-name");var b=$(".swapLog.active").attr("data-path");if(a!==""&&b!==""){removeFile(b,a);setTimeout(function(){loadSettingsPage("api/?v1/settings/settings/logs","#settings-settings-logs","Log Viewer")},1500)}});$(document).on("click",".showPassword",function(){var a=$(this).parent().parent().find(".password-alt");if(a.attr("type")==="password"){a.attr("type","text")}else{a.attr("type","password")}$(this).find(".passwordToggle").toggleClass("fa-eye").toggleClass("fa-eye-slash")});$(document).on("click",".emailUser",function(){var a=$(this).parent().parent().attr("data-email");if(activeInfo.plugins["PHPMAILER-enabled"]==true){$(".emailModal").click();$("#sendEmailToInput").val(a)}else{message("Email","Plugin not setup",activeInfo.settings.notifications.position,"#FFF","warning","5000")}});$(document).on("click","a[class*=ID-]",function(){var b=$(this).attr("data-details");var c=$(this).attr("data-target")+"-metadata-info";var a=JSON.parse(b);$("."+c).html(buildCalendarMetadata(a));myLazyLoad.update()});$(document).on("change",".filter-request-input",function(){$(".request-item").parent().removeClass("hidden");var a=[];$(".filter-request-input").each(function(){var d=$(this).prop("checked");var c=$(this).attr("data-filter");if(d==false){a.push("."+c)}});$(".request-item").each(function(){var d=$(this);var c=a.join(", ");if(d.is(c)){d.parent().addClass("hidden")}});var b=$(".request-items");b.owlCarousel();b.trigger("refresh.owl.carousel");b.trigger("to.owl.carousel",0)});var typingTimer;$(document).on("keyup","#request-input",function(){clearTimeout(typingTimer);typingTimer=setTimeout(doneTyping,750)});$(document).on("keyup","#mediaSearchQuery",function(){clearTimeout(typingTimer);typingTimer=setTimeout(doneTypingMediaSearch,750)});$(document).on("keydown","#request-input",function(){clearTimeout(typingTimer)});$(document).on("keydown","#mediaSearchQuery",function(){clearTimeout(typingTimer)});$(document).on("keydown","body",function(){blockDev()});$(document).on("click",".right-side-toggle",function(){$(".right-sidebar").slideDown(50).toggleClass("shw-rside");$(".fxhdr").on("click",function(){$("body").toggleClass("fix-header")});$(".fxsdr").on("click",function(){$("body").toggleClass("fix-sidebar")});var a=$(".fxhdr");if($("body").hasClass("fix-header")){a.attr("checked",true)}else{a.attr("checked",false)}});$(document).on("mousewheel",".recent-items .owl-stage",function(a){if(a.shiftKey){if(a.deltaY>0){$(".recent-items").trigger("next.owl")}else{$(".recent-items").trigger("prev.owl")}a.preventDefault()}});$(document).on("mousewheel",".playlist-items .owl-stage",function(a){if(a.shiftKey){if(a.deltaY>0){$(".playlist-items").trigger("next.owl")}else{$(".playlist-items").trigger("prev.owl")}a.preventDefault()}});$(document).on("mousewheel",".request-items .owl-stage",function(a){if(a.shiftKey){if(a.deltaY>0){$(".request-items").trigger("next.owl")}else{$(".request-items").trigger("prev.owl")}a.preventDefault()}});Mousetrap.bind("r r",function(){reloadCurrentTab()});Mousetrap.bind("c c",function(){closeCurrentTab()});Mousetrap.bind("s s",function(){openSettings()});Mousetrap.bind("h h",function(){openHomepage()});Mousetrap.bind("f f",function(){toggleFullScreen()});Mousetrap.bind("d d",function(){toggleDebug()});Mousetrap.bind("esc",function(){$(".splash-screen").removeClass("in").addClass("hidden")});Mousetrap.bind("ctrl+shift+up",function(c){var a=$(".allTabsList a.active").parent();var b=a.prev().children();b.trigger("click");parent.focus();return false});Mousetrap.bind("ctrl+shift+down",function(c){var b=$(".allTabsList a.active").parent();var a=b.next().children();a.trigger("click");return false});$(document).on("change","#new-tab-form-chooseImage",function(b){var a=$("#new-tab-form-chooseImage").val();if(a!=="Select or type Icon"){$("#new-tab-form-inputImageNew").val(a)}});$(document).on("change","#edit-tab-form-chooseImage",function(b){var a=$("#edit-tab-form-chooseImage").val();if(a!=="Select or type Icon"){$("#edit-tab-form-inputImage").val(a)}});$(document).on("change","#new-tab-form-chooseIcon",function(b){var a=$("#new-tab-form-chooseIcon").val();if(a!=="Select or type Icon"){$("#new-tab-form-inputImageNew").val(a)}});$(document).on("change","#edit-tab-form-chooseIcon",function(b){var a=$("#edit-tab-form-chooseIcon").val();if(a!=="Select or type Icon"){$("#edit-tab-form-inputImage").val(a)}});$(document).on("change","#choose-calender-filter, #choose-calender-filter-status",function(a){filter=$("#choose-calender-filter").val();filterDownload=$("#choose-calender-filter-status").val();$("#calendar-filter-modal").modal("hide");console.log("Calendar Filter: "+filter);console.log("Calendar Filter: "+filterDownload);$("#calendar").fullCalendar("rerenderEvents");new SimpleBar($(".fc-scroller")[0])});$("#debug-input").keyup(function(a){if(a.keyCode==13){orgDebug()}});$(document).on("click",".sticon",function(){var b=$(this).attr("href");var c=$(b).find(".customtab2 > li");if(c.length!==0){var a=false;$(c).each(function(d,f){var e=$(this).hasClass("active");if(e){a=true}});if(a==false){let el=$(c).find("a").first();$(el).trigger("click")}}});$(document).on("click",".help-modal",function(){var c=$(this).attr("data-modal");var d="";var a="";$("#help-modal-title").html("");$("#help-modal-body").html("");switch(c){case"tabs":d="Tab Help";var b=[{title:"Name",body:"The text that will be displayed for that certain tab"},{title:"Category",body:"Each Tab is assigned a Category, the default is unsorted.  You may create new categories on the Category settings tab"},{title:"Group",body:"The lowest Group that will have access to this tab"},{title:"Type",body:"Internal is for Organizr pages<br/>iFrame is for all others<br/>New Window is for items to open in a new window"},{title:"Default",body:"You can choose one tab to be the first opened tab on page load"},{title:"Active",body:"Either mark a tab as active or inactive"},{title:"Splash",body:"Toggle this to add the tab to the Splash Page on page load"},{title:"Ping",body:"Enable Organizr to ping the status of the local URL of this tab"},{title:"Preload",body:"Toggle this tab to loaded in the background on page load"}];a=buildAccordion(b);break;default:return null}$("#help-modal-title").html(d);$("#help-modal-body").html(a);$(".help-modal-lg").modal("show")});$(document).on("click",".close-popup",function(){$.magnificPopup.close()});$(document).on("click",".copyDebug",function(){copyDebug();$("#internal-clipboard").trigger("click")});$(document).on("keyup","#authBackendHostPrefix-input, #authBackendHostSuffix-input",function(){var a=$("#authBackendHostPrefix-input").val()+"TestAcct"+$("#authBackendHostSuffix-input").val();$("#accountDN").html(a)});$(document).on("click",".good-health-checks",function(){homepageHealthChecks()});$(document).on("click",".showMoreHealth",function(){var a=$(this).attr("data-id");$(".showMoreHealthDiv-"+a).toggleClass("d-none");$(this).find(".card-body").toggleClass("healthPosition")});$(document).on("click",".ipInfo",function(){$.getJSON("https://ipinfo.io/"+$(this).text()+"/?token=ddd0c072ad5021",function(c){var h=(typeof c.region=="undefined")?" N/A":c.region;var g=(typeof c.ip=="undefined")?" N/A":c.ip;var i=(typeof c.hostname=="undefined")?" N/A":c.hostname;var e=(typeof c.loc=="undefined")?" N/A":c.loc;var j=(typeof c.org=="undefined")?" N/A":c.org;var d=(typeof c.city=="undefined")?" N/A":c.city;var b=(typeof c.country=="undefined")?" N/A":c.country;var f=(typeof c.phone=="undefined")?" N/A":c.phone;var a='<div class="row"><div class="col-lg-12"><div class="white-box"><h3 class="box-title">'+g+'</h3><div class="table-responsive"><table class="table"><tbody><tr><td class="text-left">Hostname</td><td class="txt-oflo text-right">'+i+'</td></tr><tr><td class="text-left">Location</td><td class="txt-oflo text-right">'+e+'</td></tr><tr><td class="text-left">Org</td><td class="txt-oflo text-right">'+j+'</td></tr><tr><td class="text-left">City</td><td class="txt-oflo text-right">'+d+'</td></tr><tr><td class="text-left">Country</td><td class="txt-oflo text-right">'+b+'</td></tr><tr><td class="text-left">Phone</td><td class="txt-oflo text-right">'+f+'</td></tr><tr><td class="text-left">Region</td><td class="txt-oflo text-right">'+h+"</td></tr></tbody></table></div></div></div></div>";swal({content:createElementFromHTML(a),buttons:false,className:"bg-org"})})});$(document).on("click",".allGroupsList",function(){console.log($(this));$(this).toggleClass("active")});